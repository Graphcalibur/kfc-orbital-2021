/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

# ------------------------------------------------------------
# SCHEMA DUMP FOR TABLE: code_snippet
# ------------------------------------------------------------

CREATE TABLE IF NOT EXISTS `code_snippet` (
  `id` int NOT NULL AUTO_INCREMENT,
  `language` varchar(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL,
  `code` varchar(2000) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE = InnoDB AUTO_INCREMENT = 3 DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_general_ci;

# ------------------------------------------------------------
# SCHEMA DUMP FOR TABLE: score
# ------------------------------------------------------------

CREATE TABLE IF NOT EXISTS `score` (
  `playid` int NOT NULL AUTO_INCREMENT,
  `userid` int DEFAULT NULL,
  `snippetid` int NOT NULL,
  `speed` int NOT NULL,
  `accuracy` decimal(10, 5) NOT NULL,
  `time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `context` enum('Solo', 'Multiplayer') NOT NULL DEFAULT 'Solo',
  PRIMARY KEY (`playid`),
  UNIQUE KEY `playid_UNIQUE` (`playid`),
  KEY `fk_userid_idx` (`userid`),
  KEY `fk_snippetid_idx` (`snippetid`),
  CONSTRAINT `fk__scores__code_snippet` FOREIGN KEY (`snippetid`) REFERENCES `code_snippet` (`id`) ON DELETE CASCADE,
  CONSTRAINT `fk__scores__user` FOREIGN KEY (`userid`) REFERENCES `user` (`id`) ON DELETE CASCADE
) ENGINE = InnoDB AUTO_INCREMENT = 8 DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_0900_ai_ci;

# ------------------------------------------------------------
# SCHEMA DUMP FOR TABLE: user
# ------------------------------------------------------------

CREATE TABLE IF NOT EXISTS `user` (
  `id` int NOT NULL AUTO_INCREMENT,
  `username` varchar(45) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `id_UNIQUE` (`id`)
) ENGINE = InnoDB AUTO_INCREMENT = 4 DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_general_ci;

# ------------------------------------------------------------
# SCHEMA DUMP FOR TABLE: user_password
# ------------------------------------------------------------

CREATE TABLE IF NOT EXISTS `user_password` (
  `userid` int NOT NULL,
  `password_hash` varchar(200) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL,
  PRIMARY KEY (`userid`),
  UNIQUE KEY `userid_UNIQUE` (`userid`),
  CONSTRAINT `fk_userid` FOREIGN KEY (`userid`) REFERENCES `user` (`id`) ON DELETE CASCADE
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 COLLATE = utf8mb4_general_ci;

# ------------------------------------------------------------
# DATA DUMP FOR TABLE: code_snippet
# ------------------------------------------------------------

INSERT INTO
  `code_snippet` (`id`, `language`, `code`)
VALUES
  (
    1,
    'C++',
    'for (int i = 0; i < 10; ++i)\n    cout << i << endl;\n}'
  );
INSERT INTO
  `code_snippet` (`id`, `language`, `code`)
VALUES
  (
    2,
    'Python',
    'for i in range(10):\n    print(\"number\", i)\n    print(\"number squared\": i ** 2)'
  );

# ------------------------------------------------------------
# DATA DUMP FOR TABLE: score
# ------------------------------------------------------------

INSERT INTO
  `score` (
    `playid`,
    `userid`,
    `snippetid`,
    `speed`,
    `accuracy`,
    `time`,
    `context`
  )
VALUES
  (
    1,
    NULL,
    2,
    100,
    97.21000,
    '2021-06-04 13:25:44',
    'Solo'
  );
INSERT INTO
  `score` (
    `playid`,
    `userid`,
    `snippetid`,
    `speed`,
    `accuracy`,
    `time`,
    `context`
  )
VALUES
  (2, 1, 1, 84, 96.40000, '2021-06-03 13:13:07', 'Solo');
INSERT INTO
  `score` (
    `playid`,
    `userid`,
    `snippetid`,
    `speed`,
    `accuracy`,
    `time`,
    `context`
  )
VALUES
  (3, 1, 2, 66, 99.23000, '2021-06-07 20:45:57', 'Solo');
INSERT INTO
  `score` (
    `playid`,
    `userid`,
    `snippetid`,
    `speed`,
    `accuracy`,
    `time`,
    `context`
  )
VALUES
  (4, 1, 2, 68, 98.24000, '2021-06-07 21:01:55', 'Solo');
INSERT INTO
  `score` (
    `playid`,
    `userid`,
    `snippetid`,
    `speed`,
    `accuracy`,
    `time`,
    `context`
  )
VALUES
  (5, 1, 2, 78, 98.82000, '2021-06-09 21:09:55', 'Solo');
INSERT INTO
  `score` (
    `playid`,
    `userid`,
    `snippetid`,
    `speed`,
    `accuracy`,
    `time`,
    `context`
  )
VALUES
  (
    6,
    NULL,
    2,
    82,
    99.85000,
    '2021-06-09 21:11:43',
    'Solo'
  );
INSERT INTO
  `score` (
    `playid`,
    `userid`,
    `snippetid`,
    `speed`,
    `accuracy`,
    `time`,
    `context`
  )
VALUES
  (7, 1, 2, 80, 97.05000, '2021-06-09 21:12:10', 'Solo');

# ------------------------------------------------------------
# DATA DUMP FOR TABLE: user
# ------------------------------------------------------------

